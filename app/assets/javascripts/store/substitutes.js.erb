/**
 * Created with JetBrains RubyMine.
 * User: kunalch
 * Date: 31/10/12
 * Time: 11:50 AM
 * To change this template use File | Settings | File Templates.
 */

$(function () {
    var mainlist=new Array();
    var brand_s='puma';
    $.ajax({
        url: '/ws/score/'+brand_s,
        type:'GET',
        dataType: 'json',
        async: false,
        success: function(data){
          var obj;
          var main_values;
           $.each(data, function(key, val) {
                if(key == "sentiment"){
                 obj= val;
               }
          });
            $.each(obj,function(key, val) {
                if(key == "percentage"){
                main_values = val;
                }
            });
            var count=0;
            $.each(main_values,function(key, val) {
                var sublist=[];
                sublist.push(key+"");
                sublist.push(val);
                mainlist[count] = sublist;
                count=count+1;
            });
             //alert(mainlist);
        }
    });

//         var datalist=[
//            ['Nutral',70.8],
//            ['Negative',20.2],
//            ['Positive',10]
//        ];
    if(typeof Highcharts != "undefined") {

        var chart;
        var datalist=mainlist;

        function RenderPieChart(elementId, dataList){
            chart = new Highcharts.Chart({
            chart: {
                renderTo: 'brand_sentiment',
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false
            },
            colors: [
                    '#AA4643',
                    '#89A54E',
                    '#4572A7',
                    '#80699B',
                    '#3D96AE',
                    '#DB843D',
                    '#92A8CD',
                    '#A47D7C',
                    '#B5CA92'
                ],
            title: {
                text: 'Brand Sentiment'
            },
            tooltip: {
                pointFormat: ' <b>{point.percentage}%</b>',
                percentageDecimals: 1
            },
            plotOptions: {
                pie: {
                    allowPointSelect: false,
                    cursor: 'pointer',
                    size:100,
                    dataLabels: {
                        enabled: false
                    },
                    point: {
                        events: {
                            legendItemClick: function () {
                                return false; // <== returning false will cancel the default action
                            }
                        }
                    },
                    showInLegend: true
                }
            },
            credits: {
                enabled: false
            },
            exporting:{
                enabled: false
            },
            series: [{
                type: 'pie',
                data: datalist
            }]
        });
    }
        RenderPieChart('container', datalist);

    }

});